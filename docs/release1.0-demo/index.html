<html>
	<head>
		<style type="text/css">
			body {font: 82% arial,sans-serif;}
		</style>
	</head>
	<body>
		<div class="vt" id="wikimaincol">
			<p>In this demo I'm playing the role of diligent <tt>java.util.concurrent.ConcurrentHashMap</tt> maintainer with some <i>serious</i> improvements to make :) </p><p>You'll see how I use Jenkins to discover and report on performance regressions associated with my changes. </p>
			<h1>The Benchmark
			</h1><p>This is my Caliper benchmark to measure the cost of Map initialization, comparing mine to HashMap. </p><p>
				<img src="code.png"/>
			</p>
			<h1>Jenkins!
			</h1><p>Jenkins is already kindly running my CI builds to report on compile and test failures, so I'll just add a build step to run this benchmark during the build and check the "Publish Caliper microbenchmark results" box. </p><p>
				<img src="config.png"/>
			</p>
			<h1>And then...
			</h1><p>Build #4 succeeds, and is now my baseline.  </p><p>
				<img src="4.png"/>
			</p><p>Clicking to see detail... </p><p>
				<img src="4detail.png"/>
			</p><p>All is well so far. Now I'm going to check in my super awesome change to CHM. </p><p>
				<img src="5.png"/>
			</p><p>Oops, broke the build. Let's see the details. </p><p>
				<img src="5detail.png"/>
			</p><p>I see that I've improved on the number of allocations but I've regressed on the amount of memory being allocated. Time to revert... </p><p>
				<img src="6.png"/>
			</p><p>Another failure, why? Jenkins saw that in this build I've regressed on the number of allocations and isn't smart enough to know I'm simply trying to undo. See... </p><p>
				<img src="6detail.png"/>
			</p><p>However when the next build runs there will be no change and this test will pass. </p><p>
				<img src="7.png"/>
				<img src="7detail.png"/>
			</p>
			<h1>Fired
			</h1><p>Good and bad news, Jenkins has been sending these failure emails to my team, my boss included. I've just been fired from my position as <tt>java.util.concurrent.ConcurrentHashMap</tt> maintainer on the grounds of "careless checkins" :( </p>
		</div>
	</body>
</html>